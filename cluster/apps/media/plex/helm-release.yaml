---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: kube-plex
  namespace: flux-system
spec:
  interval: 5m
  chart:
    spec:
      chart: kube-plex
      version: 0.3.1
      sourceRef:
        kind: HelmRepository
        name: kube-plex
        namespace: flux-system
      interval: 5m
  values:
    image:
      repository: plexinc/pms-docker
      tag: 1.26.0.5715-8cf78dab3
    kubeplex:
      image:
        repository: ghcr.io/ressu/kube-plex
        tag: main
    timezone: "${TIMEZONE}"
    service:
      type: LoadBalancer
    persistence:
      data:
        claimName: media
      config:
        claimName: plex
      extraData:
        archive:
          claimName: gcrypt-host-path
          mountPath: /archive
          readOnly: true
    resources:
      requests:
        gpu.intel.com/i915: 1
        cpu: 1000m
        memory: 1000Mi
      limits:
        gpu.intel.com/i915: 1
        memory: 2000Mi